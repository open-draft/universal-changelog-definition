import { Badge } from '../components/Badge'
import { Code } from '../components/Code'
import { Message } from '../components/Message'

# Universal Changelog Definition <Badge>Draft</Badge>

<Message type="warning">
  This is a draft stage specification. The points presented in this document are
  open for discussion and subjectd to change. Please start or join a discussion{' '}
  <a href="https://github.com/open-draft/universal-changelog-definition">
    in the repository
  </a>
  .
</Message>

The key words "MUST”, "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC 2119](https://www.ietf.org/rfc/rfc2119.txt).

---

## 1. Introduction

_Universal Changelog Definition (UCD)_ is a changelog format designed to describe software changes in a form that both machines and humans can understand.

### 1.1 Purpose

The purpose of UCD is to propose a unified format of a changelog, making it more predictable for the software consumers.

Below you can find a list of existing changelog conventions with their examples and areas that can be improved.

#### Conventional Changelog ([GitHub](https://github.com/conventional-changelog/conventional-changelog))

Conventional Changelog uses a set of defined prefixes to standardize changes. Those prefixes are useful for machines to generate a proper release version, for example.

However, since the format and the content of a change description remains abstract, the value of such changelog to the end consumer is in the hands of the software distributor. In other words, Conventional Changelog does not guarantee the quality of changes description, but ensures the changes are split into defined categories.

```markdown
## Features

- feat: Added a new way to compose error messages
- feat: Function declarations are now scoped

## Fixes

- fix: "compress" no longer thrown an exception with unknown argument
```

### 1.2 Intended Audience

UCD provider is a software engineer responsible for the software.

UCD consumer is a software engineer that consumes the distributed software. UCD MAY also be consumed by an automated software for the purpose of listing the changes or guiding a human consumer through the software update process.

### 1.3 Intended Use

UCD is intended to be used as an artifact of any major/minor release of software.

---

## 2. Overall Description

## 3. Specification

### 3.1 Format

UCD MUST be written in Markdown for the following reasons:

- Markdown document can be written by humans;
- Markdown document can also be generated by machines;
- Markdown document can be rendered in any major VCS provider (GitHub,
  GitLab, Bitbucket, etc.);

### 3.1 Categories

All release changes MUST be divided into the following categories:

- **Added**. New functionality introduced in the release. Bears mainly informatory character to the consumer.
- **Removed**. Entirely removed functionality that has no suitable alternatives offered by the software. Software consumer must treat this information to review their usage of the software and provide appropriate changes.
- **Changed**. Previously present functionality that has been changed.

<Message>Where would bug fixes go?</Message>

---

## 4. Categories

### 4.1 Added

This category MUST contain an entirely new functionality and API thas has been added with the current release.

```markdown
# v1.0.0

## Added

- `getStats()`, returns the analytics result by the given container ID;
- `query.schedule()`, schedules the given command;
```

<Message>
  Should the added changes have a standardized description format?
</Message>

### 4.2 Changed

This category MUST contain changes to the previously existing API.

**Examples of such changes may include:**

- Deprecation suggestions;
- API naming, location, or application changes;
- Public configuration changes;

````markdown
# v1.0.0

## Changed

### Moves `diff` to a separate module

```diff
- import semver from 'semver'
- semver.diff(a, b)
+ import diff from 'semver/diff'
+ diff(a, b)
```
````

Each entry in this category:

- MUST include a change description represented by an arbitrary string;
- MAY include an arbitrary text description of the changes;
- MUST include a diff code block illustrating the change;

### 4.3 Removed

```markdown
# v1.0.0

<!-- Public API that is removed by this software release is described in the "Removed" category. -->

## Removed

- `getSize`
```

---

## Examples

### Feature deprecation

````markdown
# v1.0.0

## Changed

### Deprecates `getSize()` function

```diff
- import { getSize } from 'software'
- getSize(file, encoding)
+ import { getStats } from 'software'
+ getStats(file, options, encoding)
```
````

### Configuration change

````markdown
# v1.0.0

## Changed

### Uses `@babel/preset-env` instead of `babel-preset-env`

```diff
# babel.config.js
module.exports = {
  presets: [
-   'babel-preset-env',
+   '@babel/preset-env'
  ]
}
```
````

### Peer dependency change

````markdown
# v1.0.0

## Changed

### Uses `@emotion/styled` instead of 'emotion'

<!-- There is no public API changes introduced by this release, therefore this section contains no diff block which describes the changes. -->

#### Dependencies

<!-- Red lines represent dependencies that must be uninstalled. Green lines represent new dependencies that must be installed in order to use this version of the software. -->

```diff
- emotion
+ @emotion/styled
```
````

### Full example

````markdown
# v5.0.0

Arbitrary release notes description containing meaningful information for developers, but not so much for the machines that would be parsing this document.

## Removed

> "Removed" is the category for API changes that do not have a migration path or a suitable alternative suggested by the package owner. If there is an alternative to the removed API then it belongs to the "Changed" category.

- `getStats`
- `sortByName`, removed due to performance issues.

## Added

> "Added" category is mainly informational as there is nothing to remove nor migrate. Users upgrading to this major version would be shown that these new things are now present with the links to browse their source code.

- `generateTypeDefinitions` (+ reference link fixed to the release tag that points to this new API source code)

## Changed

### Method location change

```diff
- import semver from 'semver'
- semver.diff(a, b)
+ import semverDiff from 'semver/diff'
+ semverDiff(a, b)
```

### Method call signature change

```diff
import analyze from 'lib'
- analyze(data, options)
+ analyze(data, encoding, options)
```

#### Parameters

<!-- Get a new param based on existing param -->

- `encoding` -> `options.encoding`

### Complex webpack configuration change

```diff
# webpack.config.js
module.exports = {
  module: {
    rules: [
      {
-       options,
      }
    ]
  },
+ loaderOptions: options
}
```

#### Transform `options`

- `options.name` => `options.loaderName`

```diff
{
- name: 'svg'
+ loaderName: 'svg-loader'
}
```

### Babel configuration change

```diff
# babel.config.js
module.exports = {
  presets: [
-   'babel-presets/env',
+   '@babel/presets-env'
  ]
}
```

#### Dependencies

> Red dependencies to be uninstalled, green dependencies to be instsalled. All dependencies are related to the change they are declared in.

```diff
- babel-presets/env
+ @babel/presets-env@8.x (--save-dev)
```

### HMR now uses a different babel plugin

```diff
# babel.config.js
module.exports = {
  presets: [
+   '@babel/presets-hmr'
  ],
  plugins: [
-   'hot-loader/babel'
  ]
}
```
````

---

2019 • [GitHub](https://github.com/open-draft/universal-changelog-definition)
